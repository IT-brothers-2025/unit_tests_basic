## Что такое юнит-тест?

Юнит-тест — это автоматизированный тест, который проверяет корректность работы отдельной части программы, обычно функции или метода, в изоляции от остальной системы. Юнит-тесты помогают обнаруживать ошибки на ранних этапах разработки, обеспечивая быструю проверку изменений и предотвращая их накопление.

### Что такое юнит в юнит-тестировании?

**Юнит** — это минимальная, изолированная часть кода, которую можно протестировать. Обычно это метод класса или сам класс. Цель тестирования юнита — проверить, работает ли эта часть кода так, как задумано, независимо от других частей программы.

---

### Примеры юнитов

1. **Метод класса**
    - Пример: метод в классе для обработки заказов.
      ```java
      public double calculateDiscount(double totalPrice) {
          if (totalPrice > 100) {
              return totalPrice * 0.1;
          }
          return 0;
      }
      ```
    - Юнит: метод `calculateDiscount`.

2. **Класс**
     - В некоторых случаях полезно тестировать класс целиком как единое целое. Это уместно, если методы тесно связаны друг с другом.
     - Например, в классе BankAccount состояние (balance) влияет на работу всех методов, а логика их работы проверяется в связке.
      ```java
      public class BankAccount {
          private double balance;

          // Конструктор для установки начального баланса
          public BankAccount(double initialBalance) {
              if (initialBalance < 0) {
                  throw new IllegalArgumentException("Initial balance cannot be negative");
              }
              this.balance = initialBalance;
          }

          // Метод для получения текущего баланса
          public double getBalance() {
              return balance;
          }

          // Метод для внесения средств на счёт
          public void deposit(double amount) {
              if (amount <= 0) {
                  throw new IllegalArgumentException("Deposit amount must be positive");
              }
              balance += amount;
          }

          // Метод для снятия средств со счёта
          public void withdraw(double amount) {
              if (amount <= 0) {
                  throw new IllegalArgumentException("Withdrawal amount must be positive");
              }
              if (amount > balance) {
                  throw new IllegalArgumentException("Insufficient balance");
              }
              balance -= amount;
          }
      }
      ```
---

### Основные характеристики юнита

1. **Малый размер**  
   Юнит должен быть небольшим и выполнять одну задачу. Например, функция сложения двух чисел — идеальный юнит, так как её можно изолировать и проверить.

2. **Изоляция**  
   Юнит тестируется независимо от других частей программы. Если метод использует внешний сервис или базу данных, эти зависимости заменяются заглушками (моками).

3. **Детерминированность**  
   Результат работы юнита должен быть предсказуемым. При одинаковых входных данных он всегда должен возвращать одинаковый результат.

4. **Проверяемость**  
   Юнит должен быть легко проверяемым. Выходной результат или состояние после выполнения должны быть ясными и однозначными.

---

### Пример юнита и теста

Код:
```java
public class Calculator {
    public int add(int a, int b) {
        return a + b;
    }
}
```

Тест:
```java
import org.junit.jupiter.api.Test;
import static org.junit.jupiter.api.Assertions.*;

public class CalculatorTest {
    @Test
    void testAdd() {
        Calculator calculator = new Calculator();
        assertEquals(5, calculator.add(2, 3));
        assertEquals(0, calculator.add(-1, 1));
        assertEquals(-4, calculator.add(-2, -2));
    }
}
```

Здесь:
- **Юнит:** метод `add` в классе `Calculator`.
- **Тест:** проверяет разные сценарии (положительные, отрицательные числа и ноль).

---

### Что такое "изоляция кода" в юнит-тестировании?

Если говорить простыми словами, изоляция кода — это способ уменьшить влияние внешних факторов на наши тесты. Существует два подхода к этому: Лондонская школа и классический подход.

### **Лондонская школа**
Этот подход фокусируется на том, чтобы "отключить" зависимости тестируемого кода. Например, если у вас есть класс, который обращается к другому классу для получения данных, Лондонская школа предлагает заменить эту зависимость на что-то простое и управляемое, вроде заглушки.

Такой подход позволяет вам тестировать класс в "вакууме", полностью сосредотачиваясь на его поведении, не беспокоясь о том, как работают его зависимости.

### **Классический подход**
Классический подход сосредоточен на том, чтобы тесты не мешали друг другу. Здесь не важно, как изолирован сам тестируемый код, главное, чтобы результаты одного теста не зависели от других.

Например, если вы тестируете работу с базой данных, каждый тест должен использовать собственные данные или независимую копию базы, чтобы изменения, сделанные одним тестом, не портили результат другого.

### **Ключевая разница**
- Лондонская школа: изолирует тестируемый класс от его окружения.
- Классический подход: изолирует тесты друг от друга.
